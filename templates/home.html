{% extends 'base.html' %}

{% load widget_tweaks %}

{% block content %}
    <div class="container">
        <h1>Mailburn</h1>

        <div>
            {% if auth_url %}
                <a href="{{ auth_url }}">Log in with Google OAuth2</a>
            {% endif %}
        </div>

        <h4>Labels:</h4>
        <ul>
            {% for l in labels.labels %}
                <li>[{{ l.id }}]: {{ l.name }}</li>
            {% endfor %}
        </ul>

        <h4>Threads:</h4>
        <ul>
            {% for t in threads.threads %}
                <li>
                    <a href="?thread={{ t.id }}">{{ t.id }} [{{ t.snippet }}]: {{ t.messages }}</a>
                </li>
            {% endfor %}
        </ul>
        {% if msgs %}
            <h4>Messages:</h4>
            <ul>
                {% for m in msgs %}
                    <li>{{ m.id }} {{ m.snippet }}</li>
                {% endfor %}
            </ul>
        {% endif %}

        <div>
            <div>{{ request.user.first_name }} {{ request.user.last_name }}</div>
            <div>{{ debug }}</div>
        </div>
        <form method="POST">
            {% csrf_token %}
            <div>{{ form.errors }}</div>
            <div class="form-group">
                {{ form.to|add_class:"form-control"|attr:"placeholder:To" }}
            </div>
            <div class="form-group">
                {{ form.subject|add_class:"form-control"|attr:"placeholder:Subject" }}
            </div>
            <div class="form-group">
                {{ form.text|add_class:"form-control"|attr:"placeholder:Body" }}
            </div>
            <div class="form-group">
                <button class="btn btn-primary btn-block">Send</button>
            </div>
        </form>
        <table class="table">
            <thead>
                <td>#</td>
                <td>To</td>
                <td>Subject</td>
                <td>Body</td>
                <td>Status</td>
            </thead>
            <tbody>
                {% for m in mails %}
                    <tr>
                        <td>{{ m.pk }}</td>
                        <td>{{ m.to }}</td>
                        <td>{{ m.subject }}</td>
                        <td>{{ m.text }}</td>
                        <td>{{ m.get_status_display }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}